<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head></head><body bgcolor="white"><p><a href="lead.ou.edu">LEAD (Linked Environments for Atmospheric Discovery)</a>related functionality such as shared SOAP Header.</p><hr /><h1>LEAD Related Classes</h1><a name="lead"></a><p>LeadContextHeader wraps SOAP Header (it can wrap any XmlElement) but for convenienceuse StickySoapHeaderHandler (xsul.xhandler_soap_sticky_header.StickySoapHeaderHandler)to easily put LEAD context header on client side:</p><pre>LeadContextHeader leadContext = new LeadContextHeader("uid:experiment:233223");leadContext.setWorkflowId("http://host/2005/11/09/workflowinstace");leadContext.setNodeId("decoder1");leadContext.setTimeStep("5");leadContext.setServiceId("{http://example.org/decoder}decoder-instance-10");leadContext.setEventSink(new WsaEndpointReference(URI.create("http://broker.location/topic")));//...WSIFClient wclient = WSIFRuntime.newClient(wsdlLoc)  .addHandler(new StickySoapHeaderHandler("notif-header", leadContext))</pre><p>This handler will automatically add LEAD context header to every SOAP message sentusing WSIFClient.</p><p>On server side similarly add StickySoapHeaderHandler but in this case there is noneed to set values for LEAD context as they will be retrieved from incoming SOAP messagesent by client:</p><pre>XService xsvc = ...xsvc.addHandler(new StickySoapHeaderHandler("retrieve-lead-header", LeadContextHeader.TYPE));</pre><p>And inside a service implementation that uses such server side handler it is very easyto access LEAD context headers (due to "magic" of thread context local storage):</p><pre>LeadContextHeader nh = (LeadContextHeader) StickySoapHeaderHandler.  getHeaderAs(LeadContextHeader.class, LeadContextHeader.TYPE);</pre><p>More details and fully working exampel is in<a href="../../../../tests/xsul/async_msg/">tests/xsul/async_msg</a> directory.To run it after compiling xsul with ant and set CLASSAPTH (source classpath.sh or runclasspath.bat) execute (-Dlog is used to see headers andcheck other options to control async behavior etc.) and <samp>grep</samp> output for<samp>"lh:context"</samp>:</p><pre>java -Dlog=trace -Dstart_server xsul.async_msg.EchoAsyncClient -no_stub -count 2 -client_port 3333</pre><p>or for simple SOAP request-response:</p><pre>java -Dlog=trace -Dstart_server xsul.async_msg.EchoAsyncClient -count 2</pre><p>Last modified: $Id: package.html,v 1.1 2005/11/18 16:24:08 aslom Exp $</p></body></html>